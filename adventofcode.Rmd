---
title: "adventofcode"
author: "ahermanski"
date: "1 12 2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

Türchen Nummer 1

Stern 1

```{r}
zahlen <- read_csv("input_tag1.csv", col_names = c("expenses"))
```

```{r}
expand_grid(zahlen, zahlen, .name_repair = "minimal") %>% 
  janitor::clean_names() %>% 
  mutate(summe = expenses + expenses_2) %>% 
  filter(summe == 2020) %>% 
  mutate(product = expenses * expenses_2)
```

Stern 2

```{r}
expand_grid(zahlen, zahlen, zahlen, .name_repair = "minimal") %>% 
  janitor::clean_names() %>% 
  mutate(summe = expenses + expenses_2 + expenses_3) %>% 
  filter(summe == 2020) %>% 
  mutate(product = expenses * expenses_2 * expenses_3)
```

```{r}
zahlen2 = pull(zahlen)

expand_grid(x = zahlen2, y = zahlen2, z = zahlen2) %>% 
  mutate(summe = x + y + z) %>% 
  filter(summe == 2020) %>% 
  mutate(produkt = x * y * z)
```

Türchen Nummer 2

```{r}
input <- read_csv("input_tag2.csv", col_names = c("passw"))
```

```{r}
input %>% 
  separate(passw, into = c("a", "b", "c"), sep = "\\s") %>% 
  separate(a, into = c("l", "u")) %>% 
  mutate(l = as.integer(l), u = as.integer(u), b = str_remove(b, ":")) %>% 
  mutate(count = str_count(c, b)) %>% 
  filter(!count < l & !count > u)
```

Stern 2

```{r}
input %>% 
  separate(passw, into = c("a", "b", "c"), sep = "\\s") %>% 
  separate(a, into = c("l", "u")) %>% 
  mutate(l = as.integer(l), u = as.integer(u), b = str_remove(b, ":")) %>% 
  mutate(pos1 = str_sub(c, l, l), pos2 = str_sub(c, u, u)) %>% 
  mutate(valid = (pos1 != pos2 & (b == pos1 | b == pos2))) %>% 
  filter(valid == TRUE) 
```

Türchen 3

```{r}
input_tag3 <- read_table2("input_tag3.txt", 
    col_names = c("a"))
```

Stern 1

```{r}
input_tag3 %>% 
  mutate(b = str_dup(a, 32)) %>% 
  unite(a, b) %>% 
  mutate(b = str_length(string = a)) %>% 
  mutate(c = seq(1, 969, 3), c = as.integer(c)) %>% 
  mutate(d = substring(a, c, c)) %>% 
  mutate(e = str_count(d, "#")) %>% 
  summarise(summe = sum(e))
```

Stern 2

```{r}
slope <- function(x, y, z) {
  input_tag3 %>% 
    mutate(b = str_dup(a, ceiling(nrow(input_tag3)*x/31))) %>% 
    unite(a, b) %>% 
    slice(which(row_number() %% y == z)) %>% 
    mutate(b = str_length(string = a)) %>% 
    mutate(c = seq(1, ceiling(nrow(input_tag3) / y) * x, x), c = as.integer(c)) %>% 
    mutate(d = substring(a, c,c)) %>% 
    mutate(e = str_count(d, "#")) %>% 
    summarise(summe = sum(e)) %>% 
    pull(summe)
}
```

```{r}
rows <- tibble(x = c(1, 3, 5, 7, 1), y = c(1, 1, 1, 1, 2), z = c(0, 0, 0, 0, 1))

rows %>% 
  rowwise() %>% 
  mutate(Ergebnis = slope(x, y, z)) %>% 
  tibble() %>% 
  summarise(Ergebnis = prod(Ergebnis))
```

Türchen 4

Stern 1

https://www.reddit.com/r/adventofcode/comments/k6e8sw/2020_day_04_solutions/gel0ikl/

```{r}
input_tag4 <- tibble(pass = readLines("input_tag4.txt")) 
```

```{r}
req <- c("byr", "iyr", "eyr", "hgt", "hcl", "ecl", "pid")

gültig <- input_tag4 %>% 
  mutate(id = cumsum(pass == "")) %>% 
  filter(pass != "") %>% 
  group_by(id) %>% 
  summarise(pass = paste(pass, collapse = " ")) %>% 
  mutate(pass = str_split(pass, " ")) %>% 
  unnest(pass) %>% 
  separate(pass, into = c("schlüssel", "wert"), sep = ":") %>% 
  group_by(id) %>% 
  filter(all(req %in% c(schlüssel))) %>% 
  pivot_wider(names_from = schlüssel, values_from = wert)

gültig
```

Stern 2

```{r}
gültig %>% 
  select(8,2,5, everything()) %>% 
  mutate(across(ends_with("yr"), as.integer)) %>% 
  filter(byr >1919 & 2004 > byr, iyr > 2009 & 2021 > iyr, between(eyr, 2020, 2030),
         (str_detect(hgt, "cm") & between(parse_number(hgt), 150, 193)) | 
            (str_detect(hgt, "in") & between(parse_number(hgt), 59, 76)),
         str_detect(hcl, "^#[a-f0-9]{6}$"),
         ecl %in% c("amb", "blu", "brn", "gry", "grn", "hzl", "oth"),
         str_detect(pid, "^[0-9]{9}$")) %>% 
  nrow()
```